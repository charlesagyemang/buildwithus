<!DOCTYPE html>
<html lang="zxx">
<head>
    <title>The Nest - Real Estate HTML Template</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="google-signin-client_id" content="744014003229-cnpgth0p71r3naer2egkciqidn9677gh.apps.googleusercontent.com">

    <!-- External CSS libraries -->
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/css/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/css/bootstrap-submenu.css">
    <link rel="stylesheet" type="text/css" href="/css/bootstrap-select.min.css">
    <link rel="stylesheet" href="/css/leaflet.css" type="text/css">
    <link rel="stylesheet" href="css/map.css" type="text/css">
    <link rel="stylesheet" type="text/css" href="/fonts/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/fonts/flaticon/font/flaticon.css">
    <link rel="stylesheet" type="text/css" href="/fonts/linearicons/style.css">
    <link rel="stylesheet" type="text/css"  href="/css/jquery.mCustomScrollbar.css">
    <link rel="stylesheet" type="text/css"  href="/css/dropzone.css">

    <!-- Custom stylesheet -->
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <link rel="stylesheet" type="text/css" id="style_sheet" href="/css/skins/default.css">

    <!-- Favicon icon -->
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" >

    <!-- Google fonts -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700,800%7CPlayfair+Display:400,700%7CRoboto:100,300,400,400i,500,700">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link rel="stylesheet" type="text/css" href="css/ie10-viewport-bug-workaround.css">
    <style media="screen">

        .loginBtn {
        box-sizing: border-box;
        position: relative;
        /* width: 13em;  - apply for fixed size */
        margin: 0.2em;
        padding: 0 15px 0 46px;
        border: none;
        text-align: left;
        line-height: 34px;
        white-space: nowrap;
        border-radius: 0.2em;
        font-size: 16px;
        color: #FFF;
        }
        .loginBtn:before {
        content: "";
        box-sizing: border-box;
        position: absolute;
        top: 0;
        left: 0;
        width: 34px;
        height: 100%;
        }
        .loginBtn:focus {
        outline: none;
        }
        .loginBtn:active {
        box-shadow: inset 0 0 0 32px rgba(0,0,0,0.1);
        }


        /* Facebook */
        .loginBtn--facebook {
        background-color: #4C69BA;
        background-image: linear-gradient(#4C69BA, #3B55A0);
        /*font-family: "Helvetica neue", Helvetica Neue, Helvetica, Arial, sans-serif;*/
        text-shadow: 0 -1px 0 #354C8C;
        }
        .loginBtn--facebook:before {
        border-right: #364e92 1px solid;
        background: url('https://s3-us-west-2.amazonaws.com/s.cdpn.io/14082/icon_facebook.png') 6px 6px no-repeat;
        }
        .loginBtn--facebook:hover,
        .loginBtn--facebook:focus {
        background-color: #5B7BD5;
        background-image: linear-gradient(#5B7BD5, #4864B1);
        }


        /* Google */
        .loginBtn--google {
        /*font-family: "Roboto", Roboto, arial, sans-serif;*/
        background: #DD4B39;
        }
        .loginBtn--google:before {
        border-right: #BB3F30 1px solid;
        background: url('https://s3-us-west-2.amazonaws.com/s.cdpn.io/14082/icon_google.png') 6px 6px no-repeat;
        }
        .loginBtn--google:hover,
        .loginBtn--google:focus {
        background: #E74B37;
        }
    </style>

    <script src="https://apis.google.com/js/platform.js" async defer></script>

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script type="text/javascript" src="js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script type="text/javascript" src="js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script type="text/javascript" src="js/html5shiv.min.js"></script>
    <script type="text/javascript" src="js/respond.min.js"></script>
    <![endif]-->
</head>
<body>
  <script>
    window.fbAsyncInit = function() {
      FB.init({
        appId      : '1389092361127539',
        cookie     : true,
        xfbml      : true,
        version    : 'v2.8'
      });
      FB.AppEvents.logPageView();

    };

    (function(d, s, id){
       var js, fjs = d.getElementsByTagName(s)[0];
       if (d.getElementById(id)) {return;}
       js = d.createElement(s); js.id = id;
       js.src = "//connect.facebook.net/en_US/sdk.js";
       fjs.parentNode.insertBefore(js, fjs);
     }(document, 'script', 'facebook-jssdk'));
  </script>

<div class="page_loader"></div>

<!-- Content area start -->
<div class="content-area">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <!-- Form content box start -->
                <div class="form-content-box">
                    <!-- details -->
                    <div class="details">
                        <!-- Main title -->
                        <div class="main-title">
                            <h1><span>Signup</span></h1>
                            <h6 id="complete-gmail-signup-message"></h6>
                        </div>
                        <!-- orm start-->
                        <form>
                            <div id="sign-up-group-one" class="">
                              <div class="form-group">
                                  <input id="fullname" type="text" name="fullname" class="input-text" placeholder="Full Name">
                              </div>
                              <div class="form-group">
                                  <input  id="email" type="email" name="email" class="input-text" placeholder="Email Address">
                              </div>
                             </div>

                             <div class="form-group">
                                <span class="pull-left">+233</span><input  id="phone-number" type="text" name="phone-number" class="input-text" placeholder="Phone Number">
                             </div>

                            <div id="sign-up-group-two" class="">
                              <div class="form-group">
                                  <input  id="password" type="password" name="password" class="input-text" placeholder="Password">
                              </div>
                              <div class="form-group">
                                  <input  id="password_confirm" type="password" name="confirm_Password" class="input-text" placeholder="Confirm Password">
                              </div>
                            </div>


                            <div  class="form-group">
                              <div  id="sm-buttons"class="">
                                <button id="btn-send" type="button" class="button-md button-theme btn-block">Signup</button><br  />
                                <button id="btn-fb-login" class="loginBtn loginBtn--facebook hide" type="button" name="button">Signup With Facebook</button>
                                <center>
                                  <br  />
                                  <div class="g-signin2" style="width: 200px" data-onsuccess="onSignedIn"></div>
                                </center>
                              </div>
                                <br>
                                <button class="btn button-md button-theme hide" type="button" name="button" id="complete-gmail-signup">Complete SignUp</button>
                            </div>

                        </form>
                        <!-- Form end-->
                    </div>
                    <!-- Footer -->
                    <div id="link-go-back-to-sign-in" class="footer">
                        <span>
                            I want to <a href="/login">return to login</a>
                        </span>
                    </div>
                </div>
                <!-- Form content box end -->
            </div>
        </div>
    </div>
</div>
<!-- Copy end right-->

<script src="https://buildgallery.herokuapp.com/js/devless-sdk.js" class="devless-connection" devless-con-token="41b1f8b6dd4823f63f8eeed626bfafa8"></script>

<script type="text/javascript" src="/js/jquery-2.2.0.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/js/bootstrap-submenu.js"></script>
<script type="text/javascript" src="/js/rangeslider.js"></script>
<script type="text/javascript" src="/js/jquery.mb.YTPlayer.js"></script>
<script type="text/javascript" src="/js/wow.min.js"></script>
<script type="text/javascript" src="/js/bootstrap-select.min.js"></script>
<script type="text/javascript" src="/js/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/js/jquery.scrollUp.js"></script>
<script type="text/javascript" src="/js/jquery.mCustomScrollbar.concat.min.js"></script>
<script type="text/javascript" src="/js/leaflet.js"></script>
<script type="text/javascript" src="/js/leaflet-providers.js"></script>
<script type="text/javascript" src="/js/leaflet.markercluster.js"></script>
<script type="text/javascript" src="/js/dropzone.js"></script>
<script type="text/javascript" src="/js/maps.js"></script>
<script type="text/javascript" src="/js/app.js"></script>

<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script type="text/javascript" src="/js/ie10-viewport-bug-workaround.js"></script>
<!-- Custom javascript -->
<script type="text/javascript" src="/js/ie10-viewport-bug-workaround.js"></script>

</body>

  <script type="text/javascript">

     // Set cookies functions
      function setCookie(cname,cvalue,exdays) {
          var d = new Date();
          d.setTime(d.getTime() + (exdays*24*60*60*1000));
          var expires = "expires=" + d.toGMTString();
          document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
      }

      function createPass (val1, val2){
        return "mockervit{}" + val1 + val2 + "alovert"
      }

      function getCookie(cname) {
          var name = cname + "=";
          var decodedCookie = decodeURIComponent(document.cookie);
          var ca = decodedCookie.split(';');
          for(var i = 0; i < ca.length; i++) {
              var c = ca[i];
              while (c.charAt(0) == ' ') {
                  c = c.substring(1);
              }
              if (c.indexOf(name) == 0) {
                  return c.substring(name.length, c.length);
              }
          }
          return "";
      }


      function checkCookie(cook) {
          var token=getCookie(cook);
          if (token != "") {
            return true
          } else {
            return false
          }
      }



     // gmail login status
     function onSignedIn(googleUser) {
     //  Useful data for your client-side scripts:
     //  console.log("ID: " + profile.getId()); // Don't send this directly to your server!
     //  console.log('Full Name: ' + profile.getName());
     //  console.log('Given Name: ' + profile.getGivenName());
     //  console.log('Family Name: ' + profile.getFamilyName());
     //  console.log("Image URL: " + profile.getImageUrl());
     //  console.log("Email: " + profile.getEmail());

      var profile      = googleUser.getBasicProfile();
      var idToken      = googleUser.getAuthResponse().id_token;
      var email        = profile.getEmail();
      var givenName    = profile.getGivenName();
      var realID       = profile.getId();
      var phoneNumber  = $("#phone-number").val();

      console.log("email", email);
      console.log("givenname" , givenName);
      console.log("id_num", realID);

      var password     = createPass(email, password); //"mockervit{}" + email + givenName + "alovert";


       // hide password field and other unrelevant fields
       $("#password").addClass("hide");
       $("#password_confirm").addClass("hide");
       $("#complete-gmail-signup").removeClass("hide");
       $("#sm-buttons").addClass("hide");
       $("#link-go-back-to-sign-in").addClass("hide");
       $("#sign-up-group-two").addClass("hide");
       $("#sign-up-group-one").addClass("hide");
       $("#complete-gmail-signup-message").html("Hi dear <strong>" +  givenName + "</strong> please enter your phone number to complete sign up");


       // sign up on a button click
      $("#complete-gmail-signup").click(function(){
        // If phone ain't empty
        if ($("#phone-number").val().length > 0 && $("#phone-number").val().length < 11 ) {
          // sign them up on devless
          var signUpBody   = [email, password, '', $("#phone-number").val().trim(), givenName, '', '']
          SDK.call('devless', 'signUp', signUpBody,function(resp){
            if (resp.payload.result !== undefined ) {
              // signup success
              console.log("sign up success");

              SDK.setToken(resp.payload.result.token);
              console.log(resp.payload.result)
              // save in user cookie
              setCookie("user", JSON.stringify(resp.payload.result), 900000)

              //TODO:: redirect to after signup path

            } else {


              // Log guy in with the magic password and the
              var loginBody = ['', email, '', password];
              SDK.call('devless', 'login', loginBody, function(response){

                // check if response.payload.result is not false
                if (response.payload.result != false) {

                  // Already signed in now redirect to log in or go straight to the main page
                  console.log("Already signed up with this account. Welcome back " +  givenName);

                  SDK.setToken(response.payload.result.token);
                  console.log(response.payload.result);

                  //  save in user cookie
                  setCookie("user", JSON.stringify(response.payload.result), 900000)
                  //TODO:: Redirect to main page


                } else {
                  // something went wrong message
                  // number already in use
                  alert("Phone Number Already in use please use another phone number")
                }
              });

            }

          });

        } else {
          alert("Please Enter A valid phone number");
        }

      })
    }; // end of SignUp





    $(document).ready(function(){
      //Facebook login status
      FB.getLoginStatus(function(response) {
        if (response.status === "connected") {
          var fbResponse  = response.authResponse;
          var accessToken = fbResponse.accessToken;
          var expiresIn   = fbResponse.expiresIn;
          var userID      = fbResponse.userID;

          //console.log("fbResponse", fbResponse);

          console.log("accessToken", accessToken);
          console.log("expiresIn", expiresIn);
          console.log("userID", userID);

          //window.location.href = "/"
          // Password Algorithm

        } else {

        }
      });

      // login using facebook
      $("#btn-fb-login").click(function(){
        //Use this logic in a button
        FB.login(function(resp){
          console.log(resp);
          if (resp.status === "connected"){
            var fbResponse  = resp.authResponse;
            var accessToken = resp.accessToken;
            var expiresIn   = resp.expiresIn;
            var userID      = resp.userID;
            console.log("fbResponse_loginBtn",  fbResponse);
            console.log("accessToken_loginBtn", accessToken);
            console.log("expiresIn_loginBtn",   expiresIn);
            console.log("userID_loginBtn",      userID);
            //window.location.href = "/";

            // Password Algorithm
          }
        })
      })




      $("#btn-send").click(function(){
        var email           = $("#email").val();
        var password        = $("#password").val();
        var passwordConfirm = $("#password_confirm").val();
        var fullName        = $("#fullname").val();
        var signUpdetails   = [email, password, fullName, '', '', '', '', ''];

        if ( email.length > 0 && password.length > 0  && password === passwordConfirm) {
          SDK.call('devless', 'signUp', signUpdetails,function(resp){
            if (resp.payload.result !== undefined) {
              SDK.setToken(resp.payload.result.token);
              window.location.href = "/";
            } else {
              alert("User Already Exist");
            }
          });
        } else {
          alert("Make sure email and password fileds are not empty")
        }
      })



    })
  </script>
</html>
